using DigitalDetectivesCore.Game.SeedWork;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;

namespace DigitalDetectivesCore.Game.Models.Match
{
    public class Station : ValueObject
    {
        public static Station At(long position)
            => stations[position];

        public static List<Station> RandomInitial(int count)
        {
            Random random = new Random();
            return initial
                .OrderBy(_ => random.Next())
                .Take(count)
                .Select(p => At(p))
                .ToList();
        }

        public TicketType Type { get; }
        public bool Ferry { get; }
        public long Position { get; }

        public override bool Equals(object obj)
        {
            return obj is Station station &&
                   Position == station.Position;
        }

        private Station(TicketType type, bool ferry, long position)
        {
            Type = type;
            Ferry = Ferry;
            Position = position;
        }

        private static SortedList<long, Station> stations 
            = new SortedList<long, Station>
        {
            { 1, new Station(TicketType.Red, false, 1) }, { 2, new Station(TicketType.Yellow, false, 2) }, { 3, new Station(TicketType.Green, false, 3) }, { 4, new Station(TicketType.Yellow, false, 4) }, { 5, new Station(TicketType.Yellow, false, 5) }, { 6, new Station(TicketType.Yellow, false, 6) }, { 7, new Station(TicketType.Green, false, 7) }, { 8, new Station(TicketType.Yellow, false, 8) }, { 9, new Station(TicketType.Yellow, false, 9) }, { 10, new Station(TicketType.Yellow, false, 10) }, { 11, new Station(TicketType.Yellow, false, 11) }, { 12, new Station(TicketType.Yellow, false, 12) }, { 13, new Station(TicketType.Red, false, 13) }, { 14, new Station(TicketType.Green, false, 14) }, { 15, new Station(TicketType.Green, false, 15) }, { 16, new Station(TicketType.Yellow, false, 16) }, { 17, new Station(TicketType.Yellow, false, 17) }, { 18, new Station(TicketType.Yellow, false, 18) }, { 19, new Station(TicketType.Yellow, false, 19) }, { 20, new Station(TicketType.Yellow, false, 20) }, { 21, new Station(TicketType.Yellow, false, 21) }, { 22, new Station(TicketType.Green, false, 22) }, { 23, new Station(TicketType.Green, false, 23) }, { 24, new Station(TicketType.Yellow, false, 24) }, { 25, new Station(TicketType.Yellow, false, 25) }, { 26, new Station(TicketType.Yellow, false, 26) }, { 27, new Station(TicketType.Yellow, false, 27) }, { 28, new Station(TicketType.Yellow, false, 28) }, { 29, new Station(TicketType.Green, false, 29) }, { 30, new Station(TicketType.Yellow, false, 30) }, { 31, new Station(TicketType.Yellow, false, 31) }, { 32, new Station(TicketType.Yellow, false, 32) }, { 33, new Station(TicketType.Yellow, false, 33) }, { 34, new Station(TicketType.Green, false, 34) }, { 35, new Station(TicketType.Yellow, false, 35) }, { 36, new Station(TicketType.Yellow, false, 36) }, { 37, new Station(TicketType.Yellow, false, 37) }, { 38, new Station(TicketType.Yellow, false, 38) }, { 39, new Station(TicketType.Yellow, false, 39) }, { 40, new Station(TicketType.Yellow, false, 40) }, { 41, new Station(TicketType.Green, false, 41) }, { 42, new Station(TicketType.Green, false, 42) }, { 43, new Station(TicketType.Yellow, false, 43) }, { 44, new Station(TicketType.Yellow, false, 44) }, { 45, new Station(TicketType.Yellow, false, 45) }, { 46, new Station(TicketType.Red, false, 46) }, { 47, new Station(TicketType.Yellow, false, 47) }, { 48, new Station(TicketType.Yellow, false, 48) }, { 49, new Station(TicketType.Yellow, false, 49) }, { 50, new Station(TicketType.Yellow, false, 50) }, { 51, new Station(TicketType.Yellow, false, 51) }, { 52, new Station(TicketType.Green, false, 52) }, { 53, new Station(TicketType.Yellow, false, 53) }, { 54, new Station(TicketType.Yellow, false, 54) }, { 55, new Station(TicketType.Green, false, 55) }, { 56, new Station(TicketType.Yellow, false, 56) }, { 57, new Station(TicketType.Yellow, false, 57) }, { 58, new Station(TicketType.Green, false, 58) }, { 59, new Station(TicketType.Yellow, false, 59) }, { 60, new Station(TicketType.Yellow, false, 60) }, { 61, new Station(TicketType.Yellow, false, 61) }, { 62, new Station(TicketType.Yellow, false, 62) }, { 63, new Station(TicketType.Green, false, 63) }, { 64, new Station(TicketType.Yellow, false, 64) }, { 65, new Station(TicketType.Green, false, 65) }, { 66, new Station(TicketType.Yellow, false, 66) }, { 67, new Station(TicketType.Red, false, 67) }, { 68, new Station(TicketType.Yellow, false, 68) }, { 69, new Station(TicketType.Yellow, false, 69) }, { 70, new Station(TicketType.Yellow, false, 70) }, { 71, new Station(TicketType.Yellow, false, 71) }, { 72, new Station(TicketType.Green, false, 72) }, { 73, new Station(TicketType.Yellow, false, 73) }, { 74, new Station(TicketType.Red, false, 74) }, { 75, new Station(TicketType.Yellow, false, 75) }, { 76, new Station(TicketType.Yellow, false, 76) }, { 77, new Station(TicketType.Green, false, 77) }, { 78, new Station(TicketType.Green, false, 78) }, { 79, new Station(TicketType.Red, false, 79) }, { 80, new Station(TicketType.Yellow, false, 80) }, { 81, new Station(TicketType.Yellow, false, 81) }, { 82, new Station(TicketType.Green, false, 82) }, { 83, new Station(TicketType.Yellow, false, 83) }, { 84, new Station(TicketType.Yellow, false, 84) }, { 85, new Station(TicketType.Yellow, false, 85) }, { 86, new Station(TicketType.Green, false, 86) }, { 87, new Station(TicketType.Green, false, 87) }, { 88, new Station(TicketType.Yellow, false, 88) }, { 89, new Station(TicketType.Red, false, 89) }, { 90, new Station(TicketType.Yellow, false, 90) }, { 91, new Station(TicketType.Yellow, false, 91) }, { 92, new Station(TicketType.Yellow, false, 92) }, { 93, new Station(TicketType.Red, false, 93) }, { 94, new Station(TicketType.Green, false, 94) }, { 95, new Station(TicketType.Yellow, false, 95) }, { 96, new Station(TicketType.Yellow, false, 96) }, { 97, new Station(TicketType.Yellow, false, 97) }, { 98, new Station(TicketType.Yellow, false, 98) }, { 99, new Station(TicketType.Yellow, false, 99) }, { 100, new Station(TicketType.Green, false, 100) }, { 101, new Station(TicketType.Yellow, false, 101) }, { 102, new Station(TicketType.Green, false, 102) }, { 103, new Station(TicketType.Yellow, false, 103) }, { 104, new Station(TicketType.Yellow, false, 104) }, { 105, new Station(TicketType.Green, false, 105) }, { 106, new Station(TicketType.Yellow, false, 106) }, { 107, new Station(TicketType.Green, false, 107) }, { 108, new Station(TicketType.Green, true, 108) }, { 109, new Station(TicketType.Yellow, false, 109) }, { 110, new Station(TicketType.Yellow, false, 110) }, { 111, new Station(TicketType.Red, false, 111) }, { 112, new Station(TicketType.Yellow, false, 112) }, { 113, new Station(TicketType.Yellow, false, 113) }, { 114, new Station(TicketType.Yellow, false, 114) }, { 115, new Station(TicketType.Yellow, true, 115) }, { 116, new Station(TicketType.Green, false, 116) }, { 117, new Station(TicketType.Yellow, false, 117) }, { 118, new Station(TicketType.Yellow, false, 118) }, { 119, new Station(TicketType.Yellow, false, 119) }, { 120, new Station(TicketType.Yellow, false, 120) }, { 121, new Station(TicketType.Yellow, false, 121) }, { 122, new Station(TicketType.Green, false, 122) }, { 123, new Station(TicketType.Green, false, 123) }, { 124, new Station(TicketType.Green, false, 124) }, { 125, new Station(TicketType.Yellow, false, 125) }, { 126, new Station(TicketType.Yellow, false, 126) }, { 127, new Station(TicketType.Green, false, 127) }, { 128, new Station(TicketType.Red, false, 128) }, { 129, new Station(TicketType.Yellow, false, 129) }, { 130, new Station(TicketType.Yellow, false, 130) }, { 131, new Station(TicketType.Yellow, false, 131) }, { 132, new Station(TicketType.Yellow, false, 132) }, { 133, new Station(TicketType.Green, false, 133) }, { 134, new Station(TicketType.Yellow, false, 134) }, { 135, new Station(TicketType.Green, false, 135) }, { 136, new Station(TicketType.Yellow, false, 136) }, { 137, new Station(TicketType.Yellow, false, 137) }, { 138, new Station(TicketType.Yellow, false, 138) }, { 139, new Station(TicketType.Yellow, false, 139) }, { 140, new Station(TicketType.Red, false, 140) }, { 141, new Station(TicketType.Yellow, false, 141) }, { 142, new Station(TicketType.Green, false, 142) }, { 143, new Station(TicketType.Yellow, false, 143) }, { 144, new Station(TicketType.Green, false, 144) }, { 145, new Station(TicketType.Yellow, false, 145) }, { 146, new Station(TicketType.Yellow, false, 146) }, { 147, new Station(TicketType.Yellow, false, 147) }, { 148, new Station(TicketType.Yellow, false, 148) }, { 149, new Station(TicketType.Yellow, false, 149) }, { 150, new Station(TicketType.Yellow, false, 150) }, { 151, new Station(TicketType.Yellow, false, 151) }, { 152, new Station(TicketType.Yellow, false, 152) }, { 153, new Station(TicketType.Red, false, 153) }, { 154, new Station(TicketType.Green, false, 154) }, { 155, new Station(TicketType.Yellow, false, 155) }, { 156, new Station(TicketType.Green, false, 156) }, { 157, new Station(TicketType.Green, true, 157) }, { 158, new Station(TicketType.Yellow, false, 158) }, { 159, new Station(TicketType.Yellow, false, 159) }, { 160, new Station(TicketType.Yellow, false, 160) }, { 161, new Station(TicketType.Green, false, 161) }, { 162, new Station(TicketType.Yellow, false, 162) }, { 163, new Station(TicketType.Red, false, 163) }, { 164, new Station(TicketType.Yellow, false, 164) }, { 165, new Station(TicketType.Green, false, 165) }, { 166, new Station(TicketType.Yellow, false, 166) }, { 167, new Station(TicketType.Yellow, false, 167) }, { 168, new Station(TicketType.Yellow, false, 168) }, { 169, new Station(TicketType.Yellow, false, 169) }, { 170, new Station(TicketType.Yellow, false, 170) }, { 171, new Station(TicketType.Yellow, false, 171) }, { 172, new Station(TicketType.Yellow, false, 172) }, { 173, new Station(TicketType.Yellow, false, 173) }, { 174, new Station(TicketType.Yellow, false, 174) }, { 175, new Station(TicketType.Yellow, false, 175) }, { 176, new Station(TicketType.Green, false, 176) }, { 177, new Station(TicketType.Yellow, false, 177) }, { 178, new Station(TicketType.Yellow, false, 178) }, { 179, new Station(TicketType.Yellow, false, 179) }, { 180, new Station(TicketType.Green, false, 180) }, { 181, new Station(TicketType.Yellow, false, 181) }, { 182, new Station(TicketType.Yellow, false, 182) }, { 183, new Station(TicketType.Yellow, false, 183) }, { 184, new Station(TicketType.Green, false, 184) }, { 185, new Station(TicketType.Red, false, 185) }, { 186, new Station(TicketType.Yellow, false, 186) }, { 187, new Station(TicketType.Green, false, 187) }, { 188, new Station(TicketType.Yellow, false, 188) }, { 189, new Station(TicketType.Yellow, false, 189) }, { 190, new Station(TicketType.Green, false, 190) }, { 191, new Station(TicketType.Green, false, 191) }, { 192, new Station(TicketType.Yellow, false, 192) }, { 193, new Station(TicketType.Yellow, false, 193) }, { 194, new Station(TicketType.Yellow, true, 194) }, { 195, new Station(TicketType.Yellow, false, 195) }, { 196, new Station(TicketType.Yellow, false, 196) }, { 197, new Station(TicketType.Yellow, false, 197) }, { 198, new Station(TicketType.Yellow, false, 198) }, { 199, new Station(TicketType.Green, false, 199) }
        };

        private static List<long> initial = new List<long>
        {
            103, 112, 34, 115, 94, 117, 132, 53, 174, 198, 50, 91, 26, 29, 141, 13, 138, 197
        };
    }
}
